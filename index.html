<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Archive Grid</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f172a;
  color:#fff;
}

h1{
  text-align:center;
  padding:20px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:16px;
  padding:20px;
}

.card{
  background:#1e293b;
  border-radius:12px;
  padding:12px;
  box-shadow:0 6px 20px rgba(0,0,0,.4);
}

iframe{
  width:100%;
  height:160px;
  border-radius:8px;
  border:none;
}

.title{
  font-weight:bold;
  margin-top:10px;
}

.details{
  font-size:14px;
  opacity:.8;
}

.actions{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:10px;
}

button{
  background:#10b981;
  border:none;
  padding:8px 14px;
  border-radius:6px;
  cursor:pointer;
  color:#000;
  font-weight:bold;
}

.share{
  cursor:pointer;
  font-size:18px;
}

.fullscreen-icon {
  cursor: pointer;
  font-size: 18px;
  color: #38bdf8;
}

.home-link {
  position: fixed;
  top: 20px;
  left: 20px;
  font-size: 24px;
  cursor: pointer;
  z-index: 1000;
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  color: #fff;
}
</style>
</head>

<body>
  <a href="https://yan-shun-081.github.io/yan-1-website.com/" class="home-link">üè†</a>

<h1>üéÆ GameVault</h1>
<div class="grid" id="grid"></div>

<script>
const DATA_URL = "data1.json";
const SHARE_BASE =
  "https://page-2.github.io/yan-1-website-games-page/index.html";

// Convert archive link to embed
function toEmbed(url){
  return url.replace("/details/", "/embed/");
}

// Open folder
function openFolder(folder){
  window.location.href = folder + "/";
}

// Share link (·Øì‚û§)
function shareItem(folder, id){
  const link = `${SHARE_BASE}?id=${id}`;
  const text = `Check out and play ${folder} ${link}`;

  if(navigator.share){
    navigator.share({
      title: folder,
      text: text,
      url: link
    });
  }else{
    navigator.clipboard.writeText(text);
    alert("Share link copied to clipboard");
  }
}

// Open fullscreen embed
function openFullscreen(embedUrl) {
  // Create overlay
  const overlay = document.createElement('div');
  overlay.style.position = 'fixed';
  overlay.style.top = '0';
  overlay.style.left = '0';
  overlay.style.width = '100%';
  overlay.style.height = '100%';
  overlay.style.backgroundColor = '#000';
  overlay.style.zIndex = '9999';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';

  // Create iframe
  const iframe = document.createElement('iframe');
  iframe.src = embedUrl;
  iframe.style.width = '100%';
  iframe.style.height = '100%';
  iframe.style.border = 'none';
  iframe.allowFullscreen = true;

  // Create close button
  const closeBtn = document.createElement('button');
  closeBtn.innerText = '‚úï';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '20px';
  closeBtn.style.right = '20px';
  closeBtn.style.background = 'rgba(255, 255, 255, 0.2)';
  closeBtn.style.color = 'white';
  closeBtn.style.border = 'none';
  closeBtn.style.width = '40px';
  closeBtn.style.height = '40px';
  closeBtn.style.borderRadius = '50%';
  closeBtn.style.fontSize = '20px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.zIndex = '10000';

  closeBtn.onclick = () => {
    document.body.removeChild(overlay);
  };

  overlay.appendChild(iframe);
  overlay.appendChild(closeBtn);
  document.body.appendChild(overlay);
}

// Load grid
fetch(DATA_URL)
.then(res => res.json())
.then(data => {
  const grid = document.getElementById("grid");

  data.forEach(item => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <iframe src="${toEmbed(item.archive_image_url)}"></iframe>
      <div class="title">${item.folder}</div>
      <div class="details">${item.details}</div>
      <div class="details">ID: ${item.id}</div>
      <div class="actions">
        <button onclick="openFolder('${item.folder}')">Play</button>
        <div>
          <span class="fullscreen-icon" 
                onclick="openFullscreen('${toEmbed(item.archive_image_url)}')">‚õ∂</span>
          <span class="share"
                onclick="shareItem('${item.folder}','${item.id}')">·Øì‚û§</span>
        </div>
      </div>
    `;
    grid.appendChild(card);
  });

  handleDeepLink(data);
});

// Auto-open when visiting ?id=
function handleDeepLink(data){
  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");
  if(!id) return;

  const item = data.find(i => i.id === id);
  if(item){
    setTimeout(() => {
      openFolder(item.folder);
    }, 400);
  }
}
</script>

</body>
</html>